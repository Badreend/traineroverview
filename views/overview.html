<div id="rev_list">
    <ul id="draglist" style="height:280px">
        
        {{#each rehabilitants}}
        <li class="drag_box" userID="{{this.id}}" >
            <img src="{{this.pictureUrl}}">
            <h3>{{this.GetFullName}}</h3>   
        </li>
        {{/each}}
    </ul>
</div>
<div id='available_pods'>
    {{#each game.connectedDevices}}
    <div data-device-id="{{this.id}}" class="drop_box_container">
        <p>
            {{this.id}}
        </p>
        <ul class="drop_box">
        </ul>
    </div>
    {{/each}}
</div>


<script src="js/Sortable.js"></script>


<script type="text/javascript">


$(document).ready(function(){
    resort();
});

function resort(){
    $('.drag_box').sortable({
        connectWith: "ul",
        revert:true,
        receive: function(event, ui)
        {
            var list = $(this);
            if (list.attr('id') != "draglist") {
                console.log(list.children())
                if (list.children().length > 1) {
                    // move item back to main_list
                    $(ui.sender).sortable('cancel');
                }
            }
        }
    }).disableSelection();
}

socket.on('newDeviceConnected', function(connectedDeviceId){
    var templatePodHtml = '<div data-device-id="%id%" class="drop_box_container"> \
        <p> \
            %id% \
        </p> \
        <ul class="drop_box"> \
        </ul> \
    </div>';
     $("#available_pods").append(templatePodHtml.replace(/%id%/g, connectedDeviceId));
     resort();
});

socket.on('deviceDisconnected', function(deviceId){
    $("#available_pods div[data-device-id='"+deviceId+"']").remove();
    resort();
});

</script>