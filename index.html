<!--
Badr Ismaili 2013-2014
-->
<html>
<head>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
	<title>Trainer Overview</title>
	<style type="text/css">
		#mapDiv {
			width:600px;
			height:700px;
		}
	</style>

	<script src="jquery-1.10.1.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

	<script type="text/javascript">

	if ( !window.requestAnimationFrame ) {

		window.requestAnimationFrame = ( function() {

			return window.webkitRequestAnimationFrame ||
			window.mozRequestAnimationFrame ||
			window.oRequestAnimationFrame ||
			window.msRequestAnimationFrame ||
			function( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {

				window.setTimeout( callback, 1000 / 60 );

			};

		} )();

	}
	var socket = io.connect();

	var app = {

	}



	app.map = {
		mapDiv: undefined,
		mapOptions: undefined,
		locations:'test'
	}

	app.map.init = function(){
		mapDiv = document.getElementById("mapDiv"),
		mapOptions = {
			center: new google.maps.LatLng (52.033518, 5.337378),
			zoom: 1, 

			styles: [{"featureType":"all","elementType":"labels.text.fill","stylers":[{"color":"#ffffff"}]},{"featureType":"all","elementType":"labels.text.stroke","stylers":[{"color":"#000000"},{"lightness":13}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#000000"}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#144b53"},{"lightness":14},{"weight":1.4}]},{"featureType":"landscape","elementType":"all","stylers":[{"color":"#08304b"}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#0c4152"},{"lightness":5}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#000000"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#0b434f"},{"lightness":25}]},{"featureType":"road.arterial","elementType":"geometry.fill","stylers":[{"color":"#000000"}]},{"featureType":"road.arterial","elementType":"geometry.stroke","stylers":[{"color":"#0b3d51"},{"lightness":16}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#000000"}]},{"featureType":"transit","elementType":"all","stylers":[{"color":"#146474"}]},{"featureType":"water","elementType":"all","stylers":[{"color":"#021019"}]}]
		};

		app.map.mapObj = new google.maps.Map(mapDiv, mapOptions);
		app.map.locations = [];
		app.map.markers = [];
		locations = app.map.locations;
		locations.push ({name:"badr", LatLng: new google.maps.LatLng(52.033318, 5.337372)});
		locations.push ({name:"inge", LatLng: new google.maps.LatLng(52.035518, 5.337313)});
		locations.push ({name:"moniek", LatLng: new google.maps.LatLng(52.033518, 5.337378)});
		var iconBase = 'imgs/heads/';
		app.map.bounds = new google.maps.LatLngBounds();
		for(var i = 0; i < locations.length;i++){
			var marker = new google.maps.Marker({
				position: locations[i].LatLng, 
				map:app.map.mapObj, 
				title:locations[i].name,
				options: {
					icon: {
						url: iconBase+locations[i].name+".png",
						scaledSize: new google.maps.Size(40, 40), 
					}
				}
			});			
			app.map.bounds.extend (locations[i].LatLng);
		}
		app.map.markers.push(marker);
		app.map.mapObj.fitBounds(app.map.bounds);

	}

	function init(){
		app.map.init();
		app.map.markers[0]; 
		update();
	}

	var counter = 0;
	var tempNum = 0;  
	var tempLat = undefined;
	var tempLong = undefined;
	function update(){
		counter += 0.01;
		tempLat = Math.sin(counter) / 800 + 52.033318;
		tempLong = Math.cos(counter) / 800 + 5.337372;

		//app.map.markers[0].setPosition( new google.maps.LatLng( tempLat, tempLong ) );

		// console.log(app.map.markers[0].getPosition().lat())
		// app.map.mapObj.fitBounds(app.map.bounds);
		requestAnimationFrame(update);
	}

	window.onload = function(){
		init();
	}


	var dataInputStr = "";
	socket.on('dataClient', function(data){

		var lat = parseFloat(data.lat);
		var lon = parseFloat(data.lon);
		console.log(lat + "  " + lon)
		app.map.markers[0].setPosition( new google.maps.LatLng( lat, lon ) );

	});


	// socket.emit('idAvailable', $nickBox.val(),function(available){
	// 	console.log(available);
	// 	if(available){
	// 		nickname = $nickBox.val();
	// 		$('#nickWrap').hide();
	// 		$('#controllerWrap').show();
	// 		controller.bindEvents();
	// 		controller.draw();
	// 		console.log(canvas)
	// 		text = "name: "+nickname;


	// 	} else{
	// 		$nickError.html('That name is already taken.');
	// 	}

	// 	sendData:function(){
	// 		socket.emit('controllerInput',{
	// 			'id':nickname,
	// 			'leftButton': controller.direction.left,
	// 			'rightButton': controller.direction.right,
	// 			'upButton':controller.direction.up,
	// 			'downButton':controller.direction.down,
	// 			'radians':controller.stick.angle,
	// 			'dash':controller.stick.dash,
	// 			'distance':controller.stick.distance,
	// 			'screenWidth':canvas.width,
	// 			'tapped':controller.stick.tapped
	// 		});
	// 		console.log('sendData')
	// 	},


// // serverInput
// socket.on('idsOnline', function(dataId,dataLoc){
// 	idsOnline = dataId.length;
// 	ids = dataId;
// 	idsLoc = dataLoc;
// });

// socket.on('playerChangeColor', function(data){
// 	if(data.id === nickname){
// 		controller.playerColor = data.color;
// 	}
// });


</script>
</head>
<body>
	<div id="mapDiv"></div>
</body>
</html>